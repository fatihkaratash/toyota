# Toyota Exchange Rate Processing Application

This application processes currency exchange rates from multiple sources, performs calculations, and distributes the results.

## Architecture

The application is built on Spring Boot and uses:
- Kafka for messaging
- Redis for caching
- Dynamic calculation strategies

## Calculation Strategies

The application supports multiple ways to implement calculation formulas:

1. **Java Classes**: Create classes that implement the `CalculationStrategy` interface (recommended)
   - See examples: `UsdTryFormula`, `EurTryFormula`, `GbpTryFormula`
   - Most performant and type-safe option

2. **JavaScript**: Create scripts using JavaScript syntax
   - Supported through GraalVM JavaScript engine
   - Good for dynamic scenarios where hot-reloading is needed

3. **Groovy** (Optional): Create scripts using Groovy syntax
   - Note: This can be removed if not needed
   - Useful if you need more Java-like syntax in scripts

## Running the Application

### Prerequisites
- Java 21 or higher
- Maven
- Redis (for caching)
- Kafka (for messaging)

### Build and Run
```bash
# Build the application
mvn clean package

# Run the application
java -jar target/main-application-0.0.1-SNAPSHOT.jar
```

### Docker
```bash
# Build Docker image
docker build -t toyota/main-application .

# Run with Docker
docker run -p 8082:8082 toyota/main-application
```

## Configuration Options

All configurations are in `application.properties` and can be overridden with environment variables.

## Troubleshooting

### Groovy Dependency Issues

If you encounter Groovy-related errors during build:

1. **Option A**: Remove Groovy support
   - Remove Groovy dependencies from pom.xml
   - Remove GroovyScriptEngine.java
   - Update CalculationConfig.java to remove Groovy references

2. **Option B**: Fix Groovy dependencies
   - Ensure compatible versions of Groovy and Java
   - Add explicit dependencies for groovy-jsr223

### Redis Connection Issues

Ensure Redis is running and accessible at the configured host/port.

## Handling Redis Connection Issues

```java
// Edit RedisConnectionFactory configuration
@Bean
public RedisConnectionFactory redisConnectionFactory() {
    // Customize connection settings
}
```